<!DOCTYPE html>
<html>
<head>
	<title>Perlin Noise Terrain</title>
	<script src="p5.js"></script>
    <script src="sketch.js"></script>
	<style>
		canvas {
			display: block;
			margin: 0 auto;
		}
	</style>
</head>
<body>
	<script>
		let rows, cols;
		let scl = 20;
		let w = 1200;
		let h = 600;

		let terrain = [];
		let flying = 0;
		let speed = 0.05;
		let camX = 0;
		let camY = -200;
		let camZ = 500;

		function setup() {
		  createCanvas(w, h, WEBGL);

		  rows = w / scl;
		  cols = h / scl;

		  for (let x = 0; x < rows; x++) {
		    terrain[x] = [];
		    for (let y = 0; y < cols; y++) {
		      terrain[x][y] = 0;
		    }
		  }
		}

		function draw() {
		  background(255);

		  stroke(0, 255, 0);
		  noFill();

		  // move and rotate camera
		  camX = map(mouseX, 0, width, -w / 2, w / 2);
		  camY = map(mouseY, 0, height, -h / 2, h / 2);
		  camera(camX, camY, camZ, camX, camY, 0, 0, 1, 0);

		  // generate terrain
		  for (let y = 0; y < cols; y++) {
		    for (let x = 0; x < rows; x++) {
		      terrain[x][y] = map(noise(x * 0.1, y * 0.1, 0), 0, 1, -100, 100);
		    }
		  }

		  // draw terrain
		  for (let y = 0; y < cols - 1; y++) {
		    beginShape(TRIANGLE_STRIP);
		    for (let x = 0; x < rows; x++) {
		      vertex(x * scl, y * scl, terrain[x][y]);
		      vertex(x * scl, (y + 1) * scl, terrain[x][y + 1]);
		    }
		    endShape();
		  }

		  // move through terrain
		  flying -= speed;
		}

	</script>
</body>
</html>
